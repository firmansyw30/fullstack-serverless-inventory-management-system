swagger: "2.0"
info:
  title: Inventory Management API
  version: "1.0.0"
  description: API Gateway + Cloud Functions Gen 2

schemes:
  - https
consumes:
  - application/json
produces:
  - application/json

securityDefinitions:
  api_key:
    type: apiKey
    name: x-api-key
    in: header

security:
  - api_key: []

paths:
  /items:
    get:
      summary: Get items
      operationId: getItems
      parameters:
        - name: itemId
          in: query
          type: string
          required: false
      responses:
        200:
          description: OK
          schema:
            $ref: "#/definitions/ItemsResponse"
      x-google-backend:
        address: ${get_items_url}

    post:
      summary: Create item
      operationId: createItem
      parameters:
        - in: body
          name: body
          required: true
          schema:
            $ref: "#/definitions/ItemInput"
      responses:
        201:
          description: Created
      x-google-backend:
        address: ${create_item_url}

  /items/{itemId}:
    put:
      summary: Update item
      operationId: updateItem
      parameters:
        - name: itemId
          in: path
          required: true
          type: string
        - in: body
          name: body
          required: true
          schema:
            $ref: "#/definitions/ItemUpdate"
      responses:
        200:
          description: Updated
      x-google-backend:
        address: ${update_item_url}

    delete:
      summary: Delete item
      operationId: deleteItem
      parameters:
        - name: itemId
          in: path
          required: true
          type: string
      responses:
        200:
          description: Deleted
      x-google-backend:
        address: ${delete_item_url}

  /health:
    get:
      summary: Health check
      operationId: healthCheck
      responses:
        200:
          description: OK
      x-google-backend:
        address: ${health_check_url}


definitions:
  ItemInput:
    type: object
    required:
      - name
    properties:
      name:
        type: string
      description:
        type: string
      quantity:
        type: integer
      price:
        type: number
        format: float
      category:
        type: string
      imageUrl:
        type: string

  ItemUpdate:
    type: object
    properties:
      name:
        type: string
      description:
        type: string
      quantity:
        type: integer
      price:
        type: number
        format: float
      category:
        type: string
      imageUrl:
        type: string

  Item:
    type: object
    properties:
      itemId:
        type: string
      name:
        type: string
      description:
        type: string
      quantity:
        type: integer
      price:
        type: number
        format: float
      category:
        type: string
      imageUrl:
        type: string
      createdAt:
        type: string
      updatedAt:
        type: string

  ItemsResponse:
    type: object
    properties:
      items:
        type: array
        items:
          $ref: "#/definitions/Item"
